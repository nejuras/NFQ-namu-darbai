{% extends 'base.html.twig' %}

{% block title %}Homepage - {{ parent() }}{% endblock %}
{% block stylesheets %}
    {{ parent() }}
{% endblock %}

{% block javascripts %}
    {{ parent() }}

    <script>
        $(document).ready(function () {
            console.log("All resources finished loading");

            let counter = 0;
            // add click handler for "Add" button
            $('#addButton').click(function() {
                addGift($('.newGift'), counter++, $('#giftList'));
            });

        });

        function addGift(gift, counter, giftList) {
            console.log(gift, giftList);

            const giftVal = gift.val().trim();

            if (!giftVal) {
                return;
            }

            giftList = giftList.append(`<div class="input-group mb-3" id="giftItem${counter}">\n` +
                `<input type="text" class="form-control" name="gift_list[Gifts][]" readonly value="${escapeHtml(giftVal)}" />\n` +
                '<div class="input-group-append">\n' +
                `<button type="button" class="btn btn-outline btn-secondary deleteButton" id="deleteButton" onclick="deleteGift($('#giftItem${counter}'))">x</button>\n` +
                '</div>\n' +
                '</div>');

            // gift.val('').focus();
        }

        function escapeHtml(string) {
            return (string.replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;"));
        }

        function deleteGift(giftItem) {
            giftItem.remove();
        }

    </script>
{% endblock %}

{% block body %}
    <div class="welcome d-flex justify-content-center flex-column">
        <div class="row">
            <div class="col-sm-12">
                <h1 class="welcome-heading display-4 text-white" style="text-align:center;">Giftlist</h1>
            </div>
        </div>

        <div class="container">
            <div class="col-md-12">
                <div class="row">
                    <label for="name" class="col-sm-2 col-form-label">Name:</label>
                    <div class="col">
                        {{ data.0.firstname }}
                    </div>
                </div>

                <div class="row">

                    <label for="email" class="col-sm-2 col-form-label">Email:</label>
                    <div class="col">
                        {{ data.0.email }}
                    </div>
                </div>
                <br />

                <div class="row">
                    <label for="title" class="col-sm-2 col-form-label">Title:</label>
                    <div class="col">
                        {{ data.0.title }}
                    </div>
                </div>

                <div class="row">
                    <label for="description" class="col-sm-2 col-form-label">Description:</label>
                    <div class="col">
                        {{ data.0.description }}
                    </div>
                </div>
                <div class="row">
                <label for="description" class="col-sm-2 col-form-label">Gift List:</label>
                {% for user in data %}
                    <div class="col">
                    {{ user.Gift }}

                </div>
                {% endfor %}
                </div>
                <br />

                {#<div class="input-group mb-3">#}
                {#{{ form_widget(form.Gift.Gift, {#}
                {#'attr': {#}
                {#'class': 'form-control newGift',#}
                {#'placeholder': 'Type in your wish here and press Add button'#}
                {#}})#}
                {#}}#}
                {#<div class="input-group-append">#}
                {#<button class="btn btn-primary addButton" id="addButton" type="button">Add a Gift</button>#}
                {#</div>#}
                {#</div>#}

                <div id="giftList"></div>

                <button type="submit" class="btn btn-lg btn-outline-white btn-pill btn-block saveButton">Edit</button>

                {#modal trigger#}
                <button type="button" class="btn btn-lg btn-outline-white btn-pill btn-block" data-toggle="modal" data-target="#modal">
                    Share with Friends
                </button>

                {#modal#}
                {% block modal %}
                    <div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-labelledby="modalTitle" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content container-wishlist">

                                <div class="modal-header">
                                    <h3 class="modal-title" id="modalTitle">Title</h3>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>

                                <div class="modal-body">
                                    <div class="form-group">
                                        <textarea class="form-control" title="description" id="description" rows="3"></textarea>
                                    </div>
                                    <div class="input-group mb-3">
                                        <input id="email" type="text" class="form-control" name="email"
                                               placeholder="Type your friend's email here"/>
                                        <div class="input-group-append">
                                            <button class="btn btn-outline btn-secondary addButton" id="addButton" type="button">Add Email</button>
                                        </div>
                                    </div>
                                    <div class="input-group mb-3" id="emailList"></div>
                                </div>

                                <div class="modal-footer">
                                    <div class="container-fluid">
                                        <div class="input-group mb-3">
                                            {#<input type="text" class="form-control" name="uuid" value="{{ uuid }}"/>#}
                                            <div class="input-group-append">
                                                <button type="button" class="btn btn-secondary" onclick="">Copy</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                    <div class="footer">
                        <div class="container-fluid"><br>
                            <div class="input-group mb-3">
                                <input type="text" class="form-control" name="adminLink" value="{{ data.0.uuid }}"/>
                                <div class="input-group-append">
                                    {#<button type="button" class="btn btn-success" onclick="">Copy</button>#}
                                </div>
                            </div>
                        </div>
                    </div>
                {% endblock %}

            </div>
        </div>
{% endblock %}